<?xml version="1.0" encoding="UTF-8"?><unload unload_date="2018-08-16 15:09:49" unload_format="1" unload_table="ops_unv_tmplt" unload_version="6.4.5.0"><ops_unv_tmplt action="INSERT_OR_UPDATE"><credentials_var/><broadcast_cluster/><agent/><use_common_script>false</use_common_script><credentials/><icon_filesize>2127</icon_filesize><icon>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</icon><icon_date_created>2018-08-13 10:10:53</icon_date_created><description>07-Push an image or a repository to a registry</description><sys_updated_on>2018-08-15 14:25:02</sys_updated_on><agent_var/><icon_filename>Favicon_docker.png</icon_filename><sys_id>589becdb6ad042f88b6dbcdab921671f</sys_id><output_return_text/><sys_updated_by>ops.admin</sys_updated_by><variable_prefix>doc</variable_prefix><sys_created_on>2018-08-13 10:10:53</sys_created_on><script_windows/><credentials_var_check>false</credentials_var_check><agent_cluster_var/><agent_cluster_var_check>false</agent_cluster_var_check><agent_var_check>false</agent_var_check><sys_created_by>ops.admin</sys_created_by><output_return_nline>100</output_return_nline><output_return_sline>1</output_return_sline><exit_code_text/><runtime_dir/><output_type>1</output_type><desktop_interact>false</desktop_interact><output_return_type>1</output_return_type><script_unix>#!/usr/bin/env bash

###################################################
# 
#  Name: docker_push.sh
#  
#  Description
#  Push an image to a registry
#  syntax: docker push [OPTIONS] NAME[:TAG]
#
#
#
#
# HISTORY:
#
# Version
# 1.0   13.08.2018   Initial Version NBU
#
###################################################
version="1.0"           

## Script Control Parameter

# Exit on error. Append '||true' when you run the script if you expect an error.
set -o errexit

# Exit on empty variable
  set -o nounset
  
# Bash will remember &amp; return the highest exitcode in a chain of pipes.
set -o pipefail

# Run in debug mode, if set
if [ "${ops_doc_debug}" == "1" ]; then
  set -o xtrace
fi


# functions

docker_login () { 
   
# Set credential variables for docker registry

  case "${ops_doc_registry}" in
        "private") echo "##INFO #connecting to private docker hub with user: ${_credentialUser("${ops_doc_registry_cred}")}"
                   docker login -u ${_credentialUser("${ops_doc_registry_cred}")} -p ${_credentialPwd("${ops_doc_registry_cred}")}
            ;;
        "public") echo "##INFO #implicit login to public docker registry will be done" 
            ;;
        "dtr") echo "##INFO #connection not supported in this Universal Task Version" 
            ;;
        *) echo "echo "##INFO #connection not supported in this Universal Task Version"
            ;;
  esac
}

docker_push () {

 # CALL Docker CLI

 echo "##################################################"
 echo "pushing image tag:${ops_doc_image_tag}"
 echo "to registry: # ${ops_doc_registryhost}"
 echo "##################################################"
 # pushing image
 # docker push --disable-content-trust=true registry-host:5000/myadmin/rhel-httpd
 docker push --disable-content-trust=${ops_doc_disablecontenttrust} ${ops_doc_registryhost}/${ops_doc_image_tag}
}

docker_logout () {

 # CALL Docker CLI

 echo "##################################################"
 echo "logout from docker hub"
 echo "##################################################"

 case "${ops_doc_registry}" in
        "private") echo "##INFO #logout from private docker hub"
                   docker logout
            ;;
        "public") echo "##INFO #processing done" 
            ;;
        "dtr") echo "##INFO #connection not supported in this Universal Task Version" 
            ;;
        *) echo "##INFO #connection not supported in this Universal Task Version"
            ;;
  esac
}


# Main

docker_login
docker_push
docker_logout


# Push Samples:
# start a container e.g. alpine: docker run -it -d --name alpine_test alpine /bin/ash
# get the container id: docker ps -a  =&gt; 1bbe0f17c10f        alpine
# commit the container to a new image: docker commit 1bbe0f17c10f alpine_test
# tag the new image for upload to registry: docker tag alpine_test stonebranch/alpine_test:latest
# Now, push the image to the registry using the image ID: docker push docker.io/stonebranch/alpine_test:latest
</script_unix><output_return_file/><run_as_sudo>false</run_as_sudo><script/><agent_type>2</agent_type><script_type_windows/><environment/><agent_cluster/><elevate_user>false</elevate_user><exit_code_output/><name>docker push image - docker cli</name><exit_codes>0</exit_codes><exit_code_processing>1</exit_code_processing><create_console>false</create_console><related_items_node><ops_unv_tmplt_field action="INSERT_OR_UPDATE"><choice_sort_option>1</choice_sort_option><form_start_row>false</form_start_row><sys_updated_on>2018-08-13 10:34:50</sys_updated_on><boolean_value_type>1</boolean_value_type><required>false</required><field_mask/><boolean_no_value/><require_if_field/><sys_id>4671714ce6484e0eae15de8bfdfecb34</sys_id><require_if_field_value/><sys_updated_by>ops.admin</sys_updated_by><sys_created_on>2018-08-13 10:15:27</sys_created_on><field_value/><sys_created_by>ops.admin</sys_created_by><int_field_min/><universal_template_id>589becdb6ad042f88b6dbcdab921671f</universal_template_id><show_if_field/><boolean_yes_value/><form_col_span>1</form_col_span><field_length/><form_end_row>false</form_end_row><label>image_tag</label><int_field_max/><sequence>3</sequence><show_if_field_value/><form_row_span>1</form_row_span><default_list_view>false</default_list_view><hint/><field_mapping>textField2</field_mapping><name>image_tag</name><field_regex/><field_type>1</field_type></ops_unv_tmplt_field><ops_unv_tmplt_field action="INSERT_OR_UPDATE"><choice_sort_option>1</choice_sort_option><form_start_row>false</form_start_row><sys_updated_on>2018-08-13 10:19:05</sys_updated_on><boolean_value_type>1</boolean_value_type><required>false</required><field_mask/><boolean_no_value/><require_if_field/><sys_id>740416054e77493ebf07c75e72a29b21</sys_id><require_if_field_value/><sys_updated_by>ops.admin</sys_updated_by><sys_created_on>2018-08-13 10:11:37</sys_created_on><field_value>true</field_value><sys_created_by>ops.admin</sys_created_by><int_field_min/><universal_template_id>589becdb6ad042f88b6dbcdab921671f</universal_template_id><show_if_field/><boolean_yes_value/><form_col_span>1</form_col_span><field_length/><form_end_row>false</form_end_row><label>disable-content-trust</label><int_field_max/><sequence>0</sequence><show_if_field_value/><form_row_span>1</form_row_span><default_list_view>false</default_list_view><hint/><field_mapping>choiceField1</field_mapping><name>disablecontenttrust</name><field_regex/><field_type>4</field_type></ops_unv_tmplt_field><ops_unv_tmplt_field action="INSERT_OR_UPDATE"><choice_sort_option>1</choice_sort_option><form_start_row>false</form_start_row><sys_updated_on>2018-08-13 10:23:26</sys_updated_on><boolean_value_type>1</boolean_value_type><required>false</required><field_mask/><boolean_no_value/><require_if_field/><sys_id>78bc52c478714758992f253f3b633364</sys_id><require_if_field_value/><sys_updated_by>ops.admin</sys_updated_by><sys_created_on>2018-08-13 10:23:26</sys_created_on><field_value>0</field_value><sys_created_by>ops.admin</sys_created_by><int_field_min/><universal_template_id>589becdb6ad042f88b6dbcdab921671f</universal_template_id><show_if_field/><boolean_yes_value/><form_col_span>1</form_col_span><field_length/><form_end_row>false</form_end_row><label>debug</label><int_field_max/><sequence>6</sequence><show_if_field_value/><form_row_span>1</form_row_span><default_list_view>false</default_list_view><hint/><field_mapping>choiceField3</field_mapping><name>debug</name><field_regex/><field_type>4</field_type></ops_unv_tmplt_field><ops_unv_tmplt_field action="INSERT_OR_UPDATE"><choice_sort_option>1</choice_sort_option><form_start_row>false</form_start_row><sys_updated_on>2018-08-13 10:14:22</sys_updated_on><boolean_value_type>1</boolean_value_type><required>false</required><field_mask/><boolean_no_value/><require_if_field/><sys_id>c7ef9c76d5234ccba22a10bd5e697bcd</sys_id><require_if_field_value/><sys_updated_by>ops.admin</sys_updated_by><sys_created_on>2018-08-13 10:13:57</sys_created_on><field_value>docker.io</field_value><sys_created_by>ops.admin</sys_created_by><int_field_min/><universal_template_id>589becdb6ad042f88b6dbcdab921671f</universal_template_id><show_if_field/><boolean_yes_value/><form_col_span>1</form_col_span><field_length/><form_end_row>false</form_end_row><label>registry-host</label><int_field_max/><sequence>1</sequence><show_if_field_value/><form_row_span>1</form_row_span><default_list_view>false</default_list_view><hint>registry host e.g. registry-host:5000 or standard docker hub docker.io</hint><field_mapping>textField1</field_mapping><name>registryhost</name><field_regex/><field_type>1</field_type></ops_unv_tmplt_field><ops_unv_tmplt_field action="INSERT_OR_UPDATE"><choice_sort_option>1</choice_sort_option><form_start_row>false</form_start_row><sys_updated_on>2018-08-13 10:14:56</sys_updated_on><boolean_value_type>1</boolean_value_type><required>false</required><field_mask/><boolean_no_value/><require_if_field/><sys_id>e510fdd04dca4e2982d1e2cf3fba679b</sys_id><require_if_field_value/><sys_updated_by>ops.admin</sys_updated_by><sys_created_on>2018-08-13 10:14:56</sys_created_on><field_value/><sys_created_by>ops.admin</sys_created_by><int_field_min/><universal_template_id>589becdb6ad042f88b6dbcdab921671f</universal_template_id><show_if_field/><boolean_yes_value/><form_col_span>1</form_col_span><field_length/><form_end_row>false</form_end_row><label>registry_cred</label><int_field_max/><sequence>2</sequence><show_if_field_value/><form_row_span>1</form_row_span><default_list_view>false</default_list_view><hint/><field_mapping>credentialField1</field_mapping><name>registry_cred</name><field_regex/><field_type>5</field_type></ops_unv_tmplt_field><ops_unv_tmplt_field action="INSERT_OR_UPDATE"><choice_sort_option>1</choice_sort_option><form_start_row>false</form_start_row><sys_updated_on>2018-08-13 10:17:26</sys_updated_on><boolean_value_type>1</boolean_value_type><required>false</required><field_mask/><boolean_no_value/><require_if_field/><sys_id>f9ef08a7a7d04ca2b83631dd7d9646fe</sys_id><require_if_field_value/><sys_updated_by>ops.admin</sys_updated_by><sys_created_on>2018-08-13 10:17:26</sys_created_on><field_value>public</field_value><sys_created_by>ops.admin</sys_created_by><int_field_min/><universal_template_id>589becdb6ad042f88b6dbcdab921671f</universal_template_id><show_if_field/><boolean_yes_value/><form_col_span>1</form_col_span><field_length/><form_end_row>false</form_end_row><label>registry</label><int_field_max/><sequence>5</sequence><show_if_field_value/><form_row_span>1</form_row_span><default_list_view>false</default_list_view><hint/><field_mapping>choiceField2</field_mapping><name>registry</name><field_regex/><field_type>4</field_type></ops_unv_tmplt_field><ops_unv_tmplt_field_choice action="INSERT_OR_UPDATE"><field_id>f9ef08a7a7d04ca2b83631dd7d9646fe</field_id><use_field_value_for_label>true</use_field_value_for_label><sys_id>2c55c592259941beae60fd1079c835b2</sys_id><sequence>0</sequence><sys_updated_by>ops.admin</sys_updated_by><sys_created_on>2018-08-13 10:17:32</sys_created_on><field_value_label>public</field_value_label><field_value>public</field_value><sys_updated_on>2018-08-13 10:17:32</sys_updated_on><sys_created_by>ops.admin</sys_created_by><universal_template_id>589becdb6ad042f88b6dbcdab921671f</universal_template_id></ops_unv_tmplt_field_choice><ops_unv_tmplt_field_choice action="INSERT_OR_UPDATE"><field_id>78bc52c478714758992f253f3b633364</field_id><use_field_value_for_label>false</use_field_value_for_label><sys_id>7c3af826ab29426cbd48d29f9d98f351</sys_id><sequence>1</sequence><sys_updated_by>ops.admin</sys_updated_by><sys_created_on>2018-08-13 10:24:12</sys_created_on><field_value_label>yes</field_value_label><field_value>1</field_value><sys_updated_on>2018-08-13 10:24:12</sys_updated_on><sys_created_by>ops.admin</sys_created_by><universal_template_id>589becdb6ad042f88b6dbcdab921671f</universal_template_id></ops_unv_tmplt_field_choice><ops_unv_tmplt_field_choice action="INSERT_OR_UPDATE"><field_id>f9ef08a7a7d04ca2b83631dd7d9646fe</field_id><use_field_value_for_label>true</use_field_value_for_label><sys_id>7ffc8ce719474fdeb9636bae33fec060</sys_id><sequence>2</sequence><sys_updated_by>ops.admin</sys_updated_by><sys_created_on>2018-08-13 10:17:45</sys_created_on><field_value_label>dtr</field_value_label><field_value>dtr</field_value><sys_updated_on>2018-08-13 10:17:45</sys_updated_on><sys_created_by>ops.admin</sys_created_by><universal_template_id>589becdb6ad042f88b6dbcdab921671f</universal_template_id></ops_unv_tmplt_field_choice><ops_unv_tmplt_field_choice action="INSERT_OR_UPDATE"><field_id>78bc52c478714758992f253f3b633364</field_id><use_field_value_for_label>false</use_field_value_for_label><sys_id>8a34bfac46c24930ba5503a885b6a96a</sys_id><sequence>0</sequence><sys_updated_by>ops.admin</sys_updated_by><sys_created_on>2018-08-13 10:24:04</sys_created_on><field_value_label>no</field_value_label><field_value>0</field_value><sys_updated_on>2018-08-13 10:24:04</sys_updated_on><sys_created_by>ops.admin</sys_created_by><universal_template_id>589becdb6ad042f88b6dbcdab921671f</universal_template_id></ops_unv_tmplt_field_choice><ops_unv_tmplt_field_choice action="INSERT_OR_UPDATE"><field_id>740416054e77493ebf07c75e72a29b21</field_id><use_field_value_for_label>true</use_field_value_for_label><sys_id>95daf35b861a42a2a62f611c05d54ce9</sys_id><sequence>1</sequence><sys_updated_by>ops.admin</sys_updated_by><sys_created_on>2018-08-13 10:11:55</sys_created_on><field_value_label>false</field_value_label><field_value>false</field_value><sys_updated_on>2018-08-13 10:19:18</sys_updated_on><sys_created_by>ops.admin</sys_created_by><universal_template_id>589becdb6ad042f88b6dbcdab921671f</universal_template_id></ops_unv_tmplt_field_choice><ops_unv_tmplt_field_choice action="INSERT_OR_UPDATE"><field_id>f9ef08a7a7d04ca2b83631dd7d9646fe</field_id><use_field_value_for_label>true</use_field_value_for_label><sys_id>c10b30c6fe964a24a36aa8f2eb9bed39</sys_id><sequence>1</sequence><sys_updated_by>ops.admin</sys_updated_by><sys_created_on>2018-08-13 10:17:39</sys_created_on><field_value_label>private</field_value_label><field_value>private</field_value><sys_updated_on>2018-08-13 10:17:39</sys_updated_on><sys_created_by>ops.admin</sys_created_by><universal_template_id>589becdb6ad042f88b6dbcdab921671f</universal_template_id></ops_unv_tmplt_field_choice><ops_unv_tmplt_field_choice action="INSERT_OR_UPDATE"><field_id>740416054e77493ebf07c75e72a29b21</field_id><use_field_value_for_label>true</use_field_value_for_label><sys_id>f31af98f46ba45e5b023da9cc981dd6f</sys_id><sequence>0</sequence><sys_updated_by>ops.admin</sys_updated_by><sys_created_on>2018-08-13 10:11:45</sys_created_on><field_value_label>true</field_value_label><field_value>true</field_value><sys_updated_on>2018-08-13 10:19:12</sys_updated_on><sys_created_by>ops.admin</sys_created_by><universal_template_id>589becdb6ad042f88b6dbcdab921671f</universal_template_id></ops_unv_tmplt_field_choice></related_items_node></ops_unv_tmplt></unload>